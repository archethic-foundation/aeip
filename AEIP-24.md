---
AEIP: 24
Title: Efficient Validation and Aggregation of Signatures in Archethic Transactions
Author: Akshay Kumar KANDHI MANJUNATHA REDDY <akshay@archethic.net>
Status: Draft
Type: Standards Track
Category: Core
Created: 2023-12-12
---

# Abstract

This AEIP proposes an enhancement to the Archethic blockchain's **Transaction Chains**, **Transaction Validation Process**, **Transaction / Data Verification** using Signature Aggregation Schemes. It addresses the storage and scalability issue related to transaction validation and transaction verification, particularly in the context of sharding where not all nodes store every transaction. The proposal introduces 
1. Aggregated cross-validation
2. Aggregated storage signatures

This will help to reduce the data footprint (instead of 200 signatures only 2 aggregated signatures will be needed) and also optimize network operations.

# Specification

## Problem Statement
This AEIP concurrently solves 2 problems 

**Problem 1- Fast Verficiation of Data on Archethic**:
In the current Archethic network, a node querying other nodes that store a transaction chain has no way to verify the authenticity of this retrieved data, inorder to verify the retrieved data, the node has to collect the 200 signatures corresponding to the transaction and verify individually this is highly time consuming.

**Problem 2- Storage Space**:
Every validated transaction in a transaction chain stores 200 signatures comprising of signatures of cross validation and storage nodes' attestation. Storing these 200 signatures for every transaction is not sustainable.

## Proposed Solution
Currently below the Pending and the Validated Transactions 

![image](https://github.com/archethic-foundation/aeip/assets/75987671/9b69a945-f14b-44bb-b07c-d600a981dd26)
Where: 
@addr An unused address that corresponds to the hash of the public key of the
transaction that will succeed it in the chain.
type A type defining the functional role of the pending transaction.
timestamp The date and time of the transaction generation.
DATA Data zone containing all the operations to be performed (operation on one of
the registers, programmed tasks, smart-contracts, operations on an identity,
6
etc.)
Prev-PubKey The public key associated with the previous transaction (the address of the
previous transaction being the hash of this public key)
PrevKey Sig Signature from the private key associated with the mentioned public key
to prove the possession of the private key, the chaining of transactions and
the content of the transaction (address, type, timestamp and data area
"DATA").
OriginKey Sig Signature from the private key associated with the device or software from
which the pending transaction was generated. This signature is used for the
proof of work of the nodes (1.2.4).
Principle 2. Validated Transaction is a pending transaction completed with the validation proofs required by the Heuristic Algorithms. These validation proofs are defined
as follows (Figure 1.3):
Validation Stamp The stamp generated by the elected coordinator node and containing:
Proof of integrity proving the linkage of the previous transactions
PoW result of the Proof of Work
Ledgers Operations contains all the ledger operations that will be taken
into account by the network:
– the ledger movements mentioned in the pending transaction
DATA/Ledgers along with the issuer’s signature.
– the list of unspent transaction outputs (UTXO) of the sender’s chain on
the address of the new transaction.
– the ledger movements to the nodes that participated in the validation
and retrieval of the data (eective payment of the welcome, coordinator,
cross-validation nodes and nodes from which the data were downloaded)
DATA/Ledgers/Fee – the fees can be mentioned explicitly or not mentioned (if not, the costs will be calculated by the coordinator node).
Cryptographic signature of the Validation Stamp of the coordinating
node, the public key being already mentioned in the list of beneficiaries of
the fees.
Cross Validation Stamps To be considered as valid, the Validation Stamp must be joined
by as many Cross Validation Stamps as required by the Heuristics Algorithms. Cross Validation Stamps are the signatures of the Validation Stamp
by each of the cross-validation nodes (in case of inconsistency or disagreement it will contain the list of inconsistencies noted, all signed by the cross
validation node).

The new proposed solution consists of two aggregated entities:
1. **Aggregated Cross Validation**: Combines 197 signatures from cross-validation nodes into a single entity.
2. **Aggregated Storage Signature**: Consolidates signatures from storage nodes into one.
  
 ![image](https://github.com/archethic-foundation/aeip/assets/75987671/6159d020-49be-4da7-9595-5f908274b1b1)


These aggregates will replace the extensive list of individual signatures, reducing the signature data by a factor of 200 and enabling faster verification.

### Solution Process

1. A transaction is sent to any node (welcome node).
2. The welcome node selects validation nodes and forwards the transaction for pre-validation.
3. Validation nodes retrieve necessary transactions for validation.
4. Cross-validation nodes rebuild the context and communicate with the coordinating node.
5. The coordinator node rebuilds the transaction context, completes the validation, and issues a validation stamp.
6. Cross-validation nodes verify the validation stamp and issue their own stamps.
7. Nodes begin the replication process and notify completion.
8. Aggregated signatures are computed and replace individual transaction signatures.

## Transaction Validation Process Diagram

(Include Solution Diagram here)

# Motivation

The current transaction validation method in Archethic is not scalable and requires significant network resources. This proposal aims to streamline the process, ensuring robust security and efficiency.

# Rationale

The proposed solution not only saves storage space but also accelerates the data verification process on the Archethic network, which is crucial for maintaining high throughput and scalability as the network grows.

# Backwards Compatibility

The proposed changes are backwards compatible as they enhance the validation process without altering the underlying transaction structure.

# Reference Implementation

(Reference implementation details would be provided here, including any necessary code snippets and test cases.)

# Appendix

(Any auxiliary files, diagrams, or additional information would be listed here.)

---

